{"ast":null,"code":"import React,{Fragment,useState,useEffect}from'react';import MetaData from'../layout/MetaData';import{useAlert}from'react-alert';import{useDispatch,useSelector}from'react-redux';import{updateProfile,loadUser,clearErrors}from'../../actions/userActions';import{UPDATE_PROFILE_RESET}from'../../constants/userConstants';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const UpdateProfile=_ref=>{let{history}=_ref;const[name,setName]=useState('');const[email,setEmail]=useState('');const[phone,setPhone]=useState('');const[address,setAddress]=useState('');const[avatar,setAvatar]=useState('');const[avatarPreview,setAvatarPreview]=useState('/images/default_avatar.jpg');const alert=useAlert();const dispatch=useDispatch();const{user}=useSelector(state=>state.auth);const{error,isUpdated,loading}=useSelector(state=>state.user);useEffect(()=>{if(user){setName(user.name);setEmail(user.email);setPhone(user.phone);setAddress(user.address);setAvatarPreview(user.avatar.url);}if(error){alert.error(error);dispatch(clearErrors());}if(isUpdated){alert.success('Cập nhật thành công');dispatch(loadUser());history.push('/me');dispatch({type:UPDATE_PROFILE_RESET});}},[dispatch,alert,error,history,isUpdated,user]);const submitHandler=e=>{e.preventDefault();const formData=new FormData();formData.set('name',name);formData.set('email',email);formData.set('avatar',avatar);formData.set('phone',phone);formData.set('address',address);dispatch(updateProfile(formData));};const onChange=e=>{const reader=new FileReader();reader.onload=()=>{if(reader.readyState===2){setAvatarPreview(reader.result);setAvatar(reader.result);}};reader.readAsDataURL(e.target.files[0]);};return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(MetaData,{title:'Sửa thông tin cá nhân'}),/*#__PURE__*/_jsx(\"div\",{className:\"row wrapper\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-10 col-lg-5\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"shadow-lg\",onSubmit:submitHandler,encType:\"multipart/form-data\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"mt-2 mb-5\",children:\"S\\u1EEDa th\\xF4ng tin c\\xE1 nh\\xE2n\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email_field\",children:\"T\\xEAn\"}),/*#__PURE__*/_jsx(\"input\",{type:\"name\",id:\"name_field\",className:\"form-control\",name:\"name\",value:name,onChange:e=>setName(e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email_field\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",id:\"email_field\",className:\"form-control\",name:\"email\",value:email,onChange:e=>setEmail(e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"Phone_field\",children:\"S\\u1ED1 \\u0111i\\u1EC7n tho\\u1EA1i\"}),/*#__PURE__*/_jsx(\"input\",{type:\"Number\",id:\"phone_field\",className:\"form-control\",name:\"phone\",value:phone,onChange:e=>setPhone(e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"address_field\",children:\"\\u0110\\u1ECBa ch\\u1EC9\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"address_field\",className:\"form-control\",name:\"address\",value:address,onChange:e=>setAddress(e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"avatar_upload\",children:\"\\u1EA2nh \\u0111\\u1EA1i di\\u1EC7n\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex align-items-center\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"figure\",{className:\"avatar mr-3 item-rtl\",children:/*#__PURE__*/_jsx(\"img\",{src:avatarPreview,className:\"rounded-circle\",alt:\"Avatar Preview\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"custom-file\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",name:\"avatar\",className:\"custom-file-input\",id:\"customFile\",accept:\"image/*\",onChange:onChange}),/*#__PURE__*/_jsx(\"label\",{className:\"custom-file-label\",htmlFor:\"customFile\",children:\"Ch\\u1ECDn \\u1EA3nh\"})]})]})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn update-btn btn-block mt-4 mb-3\",disabled:loading?true:false,children:\"X\\xE1c nh\\u1EADn\"})]})})})]});};export default UpdateProfile;","map":{"version":3,"names":["React","Fragment","useState","useEffect","MetaData","useAlert","useDispatch","useSelector","updateProfile","loadUser","clearErrors","UPDATE_PROFILE_RESET","jsx","_jsx","jsxs","_jsxs","UpdateProfile","_ref","history","name","setName","email","setEmail","phone","setPhone","address","setAddress","avatar","setAvatar","avatarPreview","setAvatarPreview","alert","dispatch","user","state","auth","error","isUpdated","loading","url","success","push","type","submitHandler","e","preventDefault","formData","FormData","set","onChange","reader","FileReader","onload","readyState","result","readAsDataURL","target","files","children","title","className","onSubmit","encType","htmlFor","id","value","src","alt","accept","disabled"],"sources":["C:/Users/phamtiendung/Downloads/doan_2/doan/doan/frontend/src/components/user/UpdateProfile.js"],"sourcesContent":["import React, { Fragment, useState, useEffect } from 'react'\n\nimport MetaData from '../layout/MetaData'\n\nimport { useAlert } from 'react-alert'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { updateProfile, loadUser, clearErrors } from '../../actions/userActions'\nimport { UPDATE_PROFILE_RESET } from '../../constants/userConstants'\n\nconst UpdateProfile = ({ history }) => {\n  const [name, setName] = useState('')\n  const [email, setEmail] = useState('')\n  const [phone, setPhone] = useState('')\n  const [address, setAddress] = useState('')\n  const [avatar, setAvatar] = useState('')\n  const [avatarPreview, setAvatarPreview] = useState(\n    '/images/default_avatar.jpg'\n  )\n\n  const alert = useAlert()\n  const dispatch = useDispatch()\n\n  const { user } = useSelector(state => state.auth)\n  const { error, isUpdated, loading } = useSelector(state => state.user)\n\n  useEffect(() => {\n    if (user) {\n      setName(user.name)\n      setEmail(user.email)\n      setPhone(user.phone)\n      setAddress(user.address)\n      setAvatarPreview(user.avatar.url)\n    }\n\n    if (error) {\n      alert.error(error)\n      dispatch(clearErrors())\n    }\n\n    if (isUpdated) {\n      alert.success('Cập nhật thành công')\n      dispatch(loadUser())\n\n      history.push('/me')\n\n      dispatch({\n        type: UPDATE_PROFILE_RESET,\n      })\n    }\n  }, [dispatch, alert, error, history, isUpdated, user])\n\n  const submitHandler = e => {\n    e.preventDefault()\n\n    const formData = new FormData()\n    formData.set('name', name)\n    formData.set('email', email)\n    formData.set('avatar', avatar)\n    formData.set('phone', phone)\n    formData.set('address', address)\n\n    dispatch(updateProfile(formData))\n  }\n\n  const onChange = e => {\n    const reader = new FileReader()\n\n    reader.onload = () => {\n      if (reader.readyState === 2) {\n        setAvatarPreview(reader.result)\n        setAvatar(reader.result)\n      }\n    }\n\n    reader.readAsDataURL(e.target.files[0])\n  }\n  return (\n    <Fragment>\n      <MetaData title={'Sửa thông tin cá nhân'} />\n\n      <div className=\"row wrapper\">\n        <div className=\"col-10 col-lg-5\">\n          <form\n            className=\"shadow-lg\"\n            onSubmit={submitHandler}\n            encType=\"multipart/form-data\"\n          >\n            <h1 className=\"mt-2 mb-5\">Sửa thông tin cá nhân</h1>\n\n            <div className=\"form-group\">\n              <label htmlFor=\"email_field\">Tên</label>\n              <input\n                type=\"name\"\n                id=\"name_field\"\n                className=\"form-control\"\n                name=\"name\"\n                value={name}\n                onChange={e => setName(e.target.value)}\n              />\n            </div>\n\n            <div className=\"form-group\">\n              <label htmlFor=\"email_field\">Email</label>\n              <input\n                type=\"email\"\n                id=\"email_field\"\n                className=\"form-control\"\n                name=\"email\"\n                value={email}\n                onChange={e => setEmail(e.target.value)}\n              />\n            </div>\n\n            <div className=\"form-group\">\n              <label htmlFor=\"Phone_field\">Số điện thoại</label>\n              <input\n                type=\"Number\"\n                id=\"phone_field\"\n                className=\"form-control\"\n                name=\"phone\"\n                value={phone}\n                onChange={e => setPhone(e.target.value)}\n              />\n            </div>\n\n            <div className=\"form-group\">\n              <label htmlFor=\"address_field\">Địa chỉ</label>\n              <input\n                type=\"text\"\n                id=\"address_field\"\n                className=\"form-control\"\n                name=\"address\"\n                value={address}\n                onChange={e => setAddress(e.target.value)}\n              />\n            </div>\n\n            <div className=\"form-group\">\n              <label htmlFor=\"avatar_upload\">Ảnh đại diện</label>\n              <div className=\"d-flex align-items-center\">\n                <div>\n                  <figure className=\"avatar mr-3 item-rtl\">\n                    <img\n                      src={avatarPreview}\n                      className=\"rounded-circle\"\n                      alt=\"Avatar Preview\"\n                    />\n                  </figure>\n                </div>\n                <div className=\"custom-file\">\n                  <input\n                    type=\"file\"\n                    name=\"avatar\"\n                    className=\"custom-file-input\"\n                    id=\"customFile\"\n                    accept=\"image/*\"\n                    onChange={onChange}\n                  />\n                  <label className=\"custom-file-label\" htmlFor=\"customFile\">\n                    Chọn ảnh\n                  </label>\n                </div>\n              </div>\n            </div>\n\n            <button\n              type=\"submit\"\n              className=\"btn update-btn btn-block mt-4 mb-3\"\n              disabled={loading ? true : false}\n            >\n              Xác nhận\n            </button>\n          </form>\n        </div>\n      </div>\n    </Fragment>\n  )\n}\n\nexport default UpdateProfile\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}